name: 'Shopware Account Plugin Github Action'
description: 'Plugin Actions with Shopware Account.'
author: 'webpiloten.'

inputs:
  version:
    description: 'Release version of FroshPluginUploader'
    required: false
    default: '0.3.11'
  command:
    description: 'Commands available: validate | update | upload'
    required: true

runs:
  using: composite
  steps:
    - run: wget 'https://github.com/FriendsOfShopware/FroshPluginUploader/releases/download/${{ inputs.version }}/frosh-plugin-upload.phar' -O frosh-plugin-upload.phar
      shell: bash

    - if: ${{ command == 'validate' || command == 'upload' }}
      run: php frosh-plugin-upload.phar ext:zip ${PLUGIN_NAME}
      shell: bash

    - if: ${{ command == 'validate' }}
      run: php frosh-plugin-upload.phar ext:validate --create $(pwd)/*.zip
      shell: bash
      
    - if: ${{ command == 'update' }}
      run: php frosh-plugin-upload.phar ext:update $(pwd)/ ${{ github.event.repository.name }}/
      shell: bash

    - if: ${{ command == 'upload' }}
      run: php frosh-plugin-upload.phar --skipCodeReview ext:upload $(pwd)/*.zip
      shell: bash
